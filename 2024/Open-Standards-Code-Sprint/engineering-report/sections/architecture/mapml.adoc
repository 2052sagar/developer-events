[[mapml]]

==== MapML


===== Introduction

Map Markup Language (MapML) is a text-based format which enables web page authors to insert maps into web pages as hypertext documents exchanged over HTTP. One of the well known implementations of MapML is the open source GeoServer software product. Through this code sprint, the MapML community sought to tackle integration of MapML into OGC APIs and potentially to demonstrate both the serving of MapML documents through such APIs and the accessing of content encoded as MapML. Experimenting with the implementation of MapML in OGC APIs is important because of the need to obtain feedback from the developer community and because MapML is a proposal to the browser community from the spatial community for natively integrating maps into web pages. In order to make that case to the browser community, there is a need to have the widest possible review and feedback from the geospatial community. 

Across society, HTML plays a key role on the Web.  Maps are therefore important enough to fit into web browsers because maps play a key role in how location is communicated across society. So on the day that browsers handle maps natively the same way that they handle images, therefore should be a wealth of content waiting to be displayed on the possibly billions of web pages that will display location information. So integrating MapML support into geospatial content management systems that are fronted by implementations of OGC Web Service Standards and OGC API Standards will be essential and so the OGC community and the MapML viewer polyfill are key to meeting that goal. 

===== Structure

The MapML Viewer is a media-like widget that can be controlled with attributes like other forms of media that can be embedded in a web page. The Map content is represented by the layer element and it comes in two flavors, _inline_ and _remote_, shown in <<mapml_structure>> on the left and right respectively. Inline content is interactive and has a Document Object Model (DOM) footprint in the web browser. In contrast, remote content can be identified by the fact that the layer has a source attribute pointing to a remote web service of OGC API. Remote content is essential mashups of ad hoc content from around the Web.

[#mapml_structure]
.The structure of MapML
image::images/mapml_structure.png[]

Although interactive content or any inline content in MapML comes in the form of map extent, map feature or map tile elements as well as metadata, all content is encoded according to the HTML rules. Of course, that means it has to be parsed by the web browser by accessing it from the HTML page, so it is encoded according to HTML rules nonetheless. Remote content is encoded according to the XHTML Namespace, and XML parsing rules, and it is naturally more rigid in terms of parsing rules and therefore can be incorporated quite readily into HTML pages. 

So map extents represent templated feature content. Map features are of course features and tiles are individual tiles. The geospatial data can be viewed through the viewer in a web page as one or more view ports on the document canvas and single or as a single or a multi page web application by using the MapML viewer element as many times as needed. 

The viewer is conceptually like the video or audio element. It has a set of built-in controls that are exemplified in <<mapml_viewer>>, and they can be turned on or off as a group or individually. The default controls are keyboard accessible and are navigable with Tab and Shift buttons. Controls are are not styleable, so if custom controls are needed, then a developer has to greater their own. That is why the controls are toggleable.

[#mapml_viewer]
.MapML Viewer
image::images/mapml_viewer.png[]

===== Layers

In MapML, a map can have zero or more layers and although for map layers fewer is oftentimes better, a map can get very visually cluttered and quickly if it has too many layers. Layers are exposed to the user through the layer control in DOM order, from the closest to the furthest. The documents are parsed in sequence based on distance from the document start. Layers control contains one level of content, so there cannot be infinitely nested content. There can only be a single layer and a single node of depth in a layer. 

===== Map

A map extent is a templated form of content that allows you to fetch more content and obscure earlier data. So a map extent is exposed in the layer control under layers, whereas individual features are not. So if control of individual features is needed, the features need to be wrapped in a layer of their own. Layers can contain feature collections, and layer content is rendered according to the 'painters model'. Features on a map are keyboard navigable, whereas projections and coordinate reference systems are dealt with as a single concept. 

////

Commented out - Text below was automatically transcribed by Outlook 365

===== Tiles

So in in math ML we recognize that tiles were the original concession of geospatial software to web architecture because there are like an. Identifiable resource that is associated to the surface of the earth. And a coordinate reference system that the tiled coordinate reference system takes this concession one step further by binding an instance of a coordinate reference system with an instance of a tile matrix set and into a single well known value of projection. For example OSM tile. So in geoserver access to map FML through the WMS, WMTS and WFS interfaces is achieved by defining the map amount. As a. A coordinate reference system authority or prefix and and that obtains us allows us to obtain map map e-mail through the get map, get tile and get feature interfaces. Because you can use SRS name equals map amount OS M tile for instance. And Geoserver manages the association being between the tile matrix set and the coordinate reference system internally, and there are a few. There are a few well known or proof of concept TCRS defined by the map and specification and there are custom TCRS which can be defined by Web developers. So as far as maps goes. Maps, for example, WMS is integrated into map PML using a templated form of markup that is called the map extent and in within a map extent we have inputs which are coded to. Ah. Coded to UM. We have map inputs which are coded according to the for WMS to the the. The bounds of the the viewport using. The position attribute for example. So these these inputs are are like a an HTML form in the sense that they treat them not like a form and. Their their the values of those inputs can be serialized into the templated link value, which is the map link here and so there are you can bind a number of variables of different names into into a request and make a a whole map request and. Similarly, you can do a get feature info that uses the whole map. And using different different REL so REL equals image. Defines a query over the whole or a map request over the whole viewport. So tiles are can be obtained and rendered similarly to to images in the sense that the the map extent is configured to show it's to have a a map length that is templated. But it has a real equal style, so the client makes requests across the whole area of the viewport and you configure the map inputs in the same manner. Features can be, you know, in line, so you can have a whole feature collection in a layer or you can have templated templated map requests just like you have for images. So you can do a real equals features map link REL equals features and obtain. Feature Collections A1 viewport map, viewport at a time. So the declare the declarative side of map and Mel is how this stuff gets created by on the server or even on the client. But the the the key to making customized customized experiences. Is through the Dom API. The document object model provided by the the web web browsers and so so. At creating an accessible map should be a beginner level coding experience. For example, in the old days view source in HTML browsers was an important way that we learned how to create web pages and the same. The same ethic is brought to maps. Here we can view source coffee paste to create our own. Mashups. But once, uh, once we are. Uh. Conversant in the the declarative vocabulary. Then we're able to use JavaScript and CSS hopefully to extend the behavior and visual style of map elements and content. And so all of these elements have a have an API that's documented on our our documentation page, so they often have properties that can be used to control state or read state from from the element. Directly. And methods are important, so things that have balance or location have a an extent property and expose the zoom to method and we also have created a Geo JSON API for. Reading and writing to your JSON from feature data that is embedded in a map. And. So and of course map elements have a wide variety of events that you can set up listeners for. So there are some resources that are listed in the presentation and that you can download and get the links from, but the the client is installable via NPM and it's documented and there are some examples that you can use and. And our Cam provides links to all these resources from the map and Mail portal on Geo dot C. OK. And also if you want to get started playing with Geos with map and all content of your own, you can download to your server and use it W the web services standards and hopefully eventually after this code Sprint or some code future code Sprint the OGC APIs.
////